app.post('/createClass',(req,res) =>{
    const classID = req.body.classID
    const teacher = req.body.teacher
   
    conn.query((`CREATE TABLE IF NOT EXISTS ${classID} ( StudentID VARCHAR(20) PRIMARY KEY, FirstName VARCHAR(50), Surname VARCHAR(50), Attended INT DEFAULT 0, Teacher VARCHAR(50) GENERATED ALWAYS AS ("${teacher}"), TotalClasses INT DEFAULT 0)`),(err,result) => {
            if (err)
            {
                console.log(err)
            }
            else
            {
                const script = (`<script> const studentID = document.querySelector("#studentID")
                const firstName = document.querySelector("#firstName")
                const surname = document.querySelector("#surname")
                const classID = document.querySelector("#classID")
                
                document.querySelector("#studentCreation").addEventListener("submit",() => {
                    if (studentID.value!= ""  && firstName.value!= "" && surname.value!= "" && classID.value!= "" )
                    {
                        notification()
                    }
                    
                })</script>`)
                res.send(script)
                console.log(`${classID} created successfully`)
            }
        })
})

app.post('/addStudents',(req,res) =>{
    const studentID = req.body.studentID
    const firstName = req.body.firstName
    const surname = req.body.surname
    const classID = req.body.classID

    conn.query((`INSERT INTO ${classID} (StudentID, FirstName, Surname) VALUES ("${studentID}", "${firstName}", "${surname}")`),(err,result) => {
        if (err)
        {
            console.log(err)
        }
        else
        {
            console.log(`${studentID} added successfully to ${classID}`)
        }
    })
    conn.query1((`CREATE TABLE IF NOT EXIST ${studentID} (ClassID, Attended, TotalClasses) VALUES`),(err,result) => {
        if (err)
        {

        }
        else
        {

        }
    })
})